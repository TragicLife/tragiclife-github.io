<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>webpack | 薛鸿杰的博客</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#6C88B7">
    
    
    <meta name="keywords" content="tool,webpack">
    <meta name="description" content="api webpack打包模块的源代码 把所有模块的代码放入到函数中，用一个数组保存起来 根据require时传入的数组索引，能知道需要哪一段代码 从数组中，根据索引取出包含我们代码的函数 执行该函数，传入一个对象 module.exports 我们的代码，按照约定，正好是用module.exports = ‘’进行赋值 调用函数结束后，module.exports从原来的空对象，就有值了 最终r">
<meta name="keywords" content="tool,webpack">
<meta property="og:type" content="article">
<meta property="og:title" content="webpack">
<meta property="og:url" content="https://tragiclife.github.io/front-end/tools/webpack/index.html">
<meta property="og:site_name" content="薛鸿杰的博客">
<meta property="og:description" content="api webpack打包模块的源代码 把所有模块的代码放入到函数中，用一个数组保存起来 根据require时传入的数组索引，能知道需要哪一段代码 从数组中，根据索引取出包含我们代码的函数 执行该函数，传入一个对象 module.exports 我们的代码，按照约定，正好是用module.exports = ‘’进行赋值 调用函数结束后，module.exports从原来的空对象，就有值了 最终r">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-02-17T04:55:03.741Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="webpack">
<meta name="twitter:description" content="api webpack打包模块的源代码 把所有模块的代码放入到函数中，用一个数组保存起来 根据require时传入的数组索引，能知道需要哪一段代码 从数组中，根据索引取出包含我们代码的函数 执行该函数，传入一个对象 module.exports 我们的代码，按照约定，正好是用module.exports = ‘’进行赋值 调用函数结束后，module.exports从原来的空对象，就有值了 最终r">
    
        <link rel="alternate" type="application/atom+xml" title="薛鸿杰的博客" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand2.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">薛鸿杰</h5>
          <a href="mailto:xuehongjiej@163.com" title="xuehongjiej@163.com" class="mail">xuehongjiej@163.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/">
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives">
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags">
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/TragicLife" target="_blank">
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">webpack</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">webpack</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-01-24T23:21:54.000Z" itemprop="datePublished" class="page-time">
  2019-01-24
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#webpack打包模块的源代码"><span class="post-toc-number">1.</span> <span class="post-toc-text">webpack打包模块的源代码</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#配置"><span class="post-toc-number">2.</span> <span class="post-toc-text">配置</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#配置参数"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">配置参数</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#webpack快捷命令"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">webpack快捷命令</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#webpack-dev-server快捷命令"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">webpack-dev-server快捷命令</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#定义全局变量"><span class="post-toc-number">2.4.</span> <span class="post-toc-text">定义全局变量</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#scss文件提取到独立文件-loader中的配置"><span class="post-toc-number">2.5.</span> <span class="post-toc-text">scss文件提取到独立文件(loader中的配置)</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#scss文件提取到独立文件-plugins中的配置"><span class="post-toc-number">2.6.</span> <span class="post-toc-text">scss文件提取到独立文件(plugins中的配置)</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#vue的scss样式提取到独立文件"><span class="post-toc-number">2.7.</span> <span class="post-toc-text">vue的scss样式提取到独立文件</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#使用全局变量"><span class="post-toc-number">2.8.</span> <span class="post-toc-text">使用全局变量</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#hash和chunkhash的区别"><span class="post-toc-number">3.</span> <span class="post-toc-text">hash和chunkhash的区别</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#常用loader"><span class="post-toc-number">4.</span> <span class="post-toc-text">常用loader</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#devServer"><span class="post-toc-number">5.</span> <span class="post-toc-text">devServer</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#提取第三方资源到单独文件"><span class="post-toc-number">6.</span> <span class="post-toc-text">提取第三方资源到单独文件</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#打包优化"><span class="post-toc-number">7.</span> <span class="post-toc-text">打包优化</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#查看项目打包-webpack-bundle-analyzer"><span class="post-toc-number">7.1.</span> <span class="post-toc-text">查看项目打包(webpack-bundle-analyzer)</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#webpack外部扩展"><span class="post-toc-number">7.2.</span> <span class="post-toc-text">webpack外部扩展</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#DLL"><span class="post-toc-number">7.3.</span> <span class="post-toc-text">DLL</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#其他"><span class="post-toc-number">8.</span> <span class="post-toc-text">其他</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#报错"><span class="post-toc-number">9.</span> <span class="post-toc-text">报错</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#webpack4"><span class="post-toc-number">10.</span> <span class="post-toc-text">webpack4</span></a></li></ol>
        </nav>
    </aside>


<article id="post-front-end/tools/webpack" class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">webpack</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-01-24 23:21:54" datetime="2019-01-24T23:21:54.000Z" itemprop="datePublished">2019-01-24</time>

            


            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style="display:none">
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <p><a href="https://webpack.docschina.org/concepts/" target="_blank" rel="noopener">api</a></p>
<h2 id="webpack打包模块的源代码"><a href="#webpack打包模块的源代码" class="headerlink" title="webpack打包模块的源代码"></a>webpack打包模块的源代码</h2><ol>
<li>把所有模块的代码放入到函数中，用一个数组保存起来</li>
<li>根据require时传入的数组索引，能知道需要哪一段代码</li>
<li>从数组中，根据索引取出包含我们代码的函数</li>
<li>执行该函数，传入一个对象 module.exports</li>
<li>我们的代码，按照约定，正好是用module.exports = ‘’进行赋值</li>
<li>调用函数结束后，module.exports从原来的空对象，就有值了</li>
<li>最终return module.exports作为require函数的返回值</li>
</ol>
<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><h3 id="配置参数"><a href="#配置参数" class="headerlink" title="配置参数"></a>配置参数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">const path = require(&apos;path&apos;);</span><br><span class="line">const HtmlWebpackPlugin = require(&apos;html-webpack-plugin&apos;)</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">  // 入口文件</span><br><span class="line">  entry: &#123;</span><br><span class="line">    main: &apos;./main.js&apos;</span><br><span class="line">    main2: &apos;./main2.js&apos;</span><br><span class="line">  &#125;,</span><br><span class="line">  // 编译后文件</span><br><span class="line">  output: &#123;</span><br><span class="line">    // 指定产出的目录</span><br><span class="line">    path: path.resolve(&apos;./dist&apos;),</span><br><span class="line">    // 指定文件名</span><br><span class="line">    filename: &apos;[name].js&apos;,</span><br><span class="line">  &#125;,</span><br><span class="line">  watch: true, // 是否监听变动</span><br><span class="line">  module: &#123;</span><br><span class="line">    // webpack后面版本可以叫做rules</span><br><span class="line">    loaders: [</span><br><span class="line">      // 处理css</span><br><span class="line">      &#123;</span><br><span class="line">        test: /.css$/,</span><br><span class="line">        loader: &apos;style-loader!css-loader&apos;</span><br><span class="line">      &#125;, </span><br><span class="line">      // 小于限制范围则生成base64到build.js中，大于则生成图片</span><br><span class="line">      &#123;</span><br><span class="line">        test: /.(jpg|jpeg|png|gif|svg)$/,</span><br><span class="line">        loader: &apos;url-loader?limit=1024&apos;</span><br><span class="line">      &#125;,</span><br><span class="line">      // 处理less文件</span><br><span class="line">      &#123;</span><br><span class="line">        test: /.less$/,</span><br><span class="line">        loader: &apos;style-loader!css-loader!less-loader&apos;</span><br><span class="line">      &#125;,</span><br><span class="line">      // 处理ES6,7,8</span><br><span class="line">      &#123;</span><br><span class="line">        test: /.js$/,</span><br><span class="line">        loader: &apos;babel-loader&apos;,</span><br><span class="line">        exclude: /node_modules/, // 不打包node_modules目录下的文件</span><br><span class="line">        options: &#123;</span><br><span class="line">          presets: [&apos;env&apos;], // 指定处理关键字</span><br><span class="line">          plugins: [&apos;transform-runtime&apos;], // 处理函数</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      // 处理.vue文件</span><br><span class="line">      &#123;</span><br><span class="line">        test: /.vue$/,</span><br><span class="line">        loader: &apos;vue-loader&apos;,</span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    new HtmlWebpackPlugin(&#123;</span><br><span class="line">      filename: &apos;index.html&apos;, // 生成相对dist的html文件名</span><br><span class="line">      template: &apos;./src/index.html&apos;, // 模板生成的参照物</span><br><span class="line">      inject: true, // 是否添加到html，默认为true</span><br><span class="line">      minify: &#123;</span><br><span class="line">        removeComments: true, // 是否移除注释</span><br><span class="line">        collapseWhitespace: true, // 是否移除空格</span><br><span class="line">        removeAttributeQuotes: true, // 是否删除不需要引号的值</span><br><span class="line">      &#125;,</span><br><span class="line">      // 页面模板需要加对应的js脚本，如果不加这行则每个页面都会引入所有的js脚本</span><br><span class="line">      chunks: [&apos;manifest&apos;, &apos;vendor&apos;, filename],</span><br><span class="line">      chunksSortMode: &apos;dependency&apos;</span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  resolve: &#123;</span><br><span class="line">    // 自动解析扩展，能够使用户在引入模块时不带扩展</span><br><span class="line">    extensions: [&apos;.js&apos;, &apos;.vue&apos;, &apos;.json&apos;],</span><br><span class="line">    // 别名</span><br><span class="line">    alias: &#123;</span><br><span class="line">      &apos;@&apos;: path.join(__dirname, &apos;..&apos;, dir)(&apos;src&apos;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>图片转成base64时，大小会增加图片的三分之一，即如果图片为9K，打包后build.js增加12K的大小</p>
</blockquote>
<h3 id="webpack快捷命令"><a href="#webpack快捷命令" class="headerlink" title="webpack快捷命令"></a>webpack快捷命令</h3><ul>
<li><code>--config webpack.dev.config.js</code> 指定编译时要运行的配置文件</li>
<li><code>--watch</code> 监听文件改变</li>
<li><code>--process</code> 显示编译进度</li>
</ul>
<h3 id="webpack-dev-server快捷命令"><a href="#webpack-dev-server快捷命令" class="headerlink" title="webpack-dev-server快捷命令"></a>webpack-dev-server快捷命令</h3><ul>
<li><code>--open</code> 自动打开浏览器</li>
<li><code>--hot</code> 热替换，不刷新的情况下替换，主要用于css的变更</li>
<li><code>--inline</code> 自动刷新</li>
<li><code>--port 8888</code> 指定端口</li>
</ul>
<h3 id="定义全局变量"><a href="#定义全局变量" class="headerlink" title="定义全局变量"></a>定义全局变量</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">plugins:[</span><br><span class="line">  new webpack.ProvidePlugin(&#123;</span><br><span class="line">    $:&apos;jquery&apos;</span><br><span class="line">  &#125;)</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h3 id="scss文件提取到独立文件-loader中的配置"><a href="#scss文件提取到独立文件-loader中的配置" class="headerlink" title="scss文件提取到独立文件(loader中的配置)"></a>scss文件提取到独立文件(loader中的配置)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ExtractTextPlugin.extract(&#123;fallback:&apos;style-loader&apos;,use:&apos;css-loader!postcss-loader!sass-loader&apos;&#125;)</span><br><span class="line">ExtractTextPlugin.extract(&#123;fallback:&apos;style-loader&apos;,use:[&apos;css-loader&apos;, &#123;loader: &apos;postcss-loader&apos;, options: &#123;sourceMap: true&#125;&#125;, &apos;sass-loader&apos;]&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="scss文件提取到独立文件-plugins中的配置"><a href="#scss文件提取到独立文件-plugins中的配置" class="headerlink" title="scss文件提取到独立文件(plugins中的配置)"></a>scss文件提取到独立文件(plugins中的配置)</h3><p>new ExtractTextPlugin(‘styles.[contentHash:8].css’)</p>
<h3 id="vue的scss样式提取到独立文件"><a href="#vue的scss样式提取到独立文件" class="headerlink" title="vue的scss样式提取到独立文件"></a>vue的scss样式提取到独立文件</h3><p>options:{loaders:{scss:ExtractTextPlugin.extract({fallback:’vue-style-loader’,use:’css-loader!postcss-loader!sass-loader})}}</p>
<p>使用sourcemap才可以在浏览器中调试</p>
<h3 id="使用全局变量"><a href="#使用全局变量" class="headerlink" title="使用全局变量"></a>使用全局变量</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;test: resolve(&apos;src/utils/index&apos;),</span><br><span class="line">use:[&#123;</span><br><span class="line">loader:&apos;expose-loader&apos;,</span><br><span class="line">options: &apos;Utils&apos; //全局变量名</span><br><span class="line">&#125;]&#125;</span><br></pre></td></tr></table></figure>
<p>设置路径~assets相当于src/assets</p>
<p>config/index.js文件中的assetsPublicPath属性需要根据服务器的路径来进行设置<br>如果后台服务器的路径不是 / ，需要设置build.assetsPublicPath属性，<br>如：后台路径为<a href="http://localhost:4100/pl-mls/car-run-activity.html，则设置该值为pl-mls/" target="_blank" rel="noopener">http://localhost:4100/pl-mls/car-run-activity.html，则设置该值为pl-mls/</a><br>如果mode为hash，则不需要修改vue-router的配置<br>如果mode为history，需要在vue-router中设置base为/pl-mls/，dev.assetsPublicPath为’/‘</p>
<h2 id="hash和chunkhash的区别"><a href="#hash和chunkhash的区别" class="headerlink" title="hash和chunkhash的区别"></a>hash和chunkhash的区别</h2><ul>
<li>hash:整个应用对应同一个hash；不利于缓存</li>
<li>chunkhash:根据内容计算所得，每个entry单独对应一个hash；上线后无改动的文件不会失去缓存</li>
</ul>
<h2 id="常用loader"><a href="#常用loader" class="headerlink" title="常用loader"></a>常用loader</h2><ul>
<li>css-loader，读取.css文件的内容</li>
<li>style-loader，将读取到的css内容插入到style标签</li>
<li>file-loader，将图片文件提取出来</li>
<li>url-loader(依赖file-loader)，将图片转为base64</li>
</ul>
<p>devtool<br>使用’#cheap-module-eval-source-map’</p>
<h2 id="devServer"><a href="#devServer" class="headerlink" title="devServer"></a>devServer</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">config.devServer:&#123;</span><br><span class="line">  port:8080, // 端口号</span><br><span class="line">  host: &apos;0.0.0.0&apos;, // 地址</span><br><span class="line">  overlay:&#123;</span><br><span class="line">    errors: true // 错误提示</span><br><span class="line">  &#125;,</span><br><span class="line">  open: true, // 自动打开浏览器</span><br><span class="line">  hot: true, // 热加载，局部修改内容</span><br><span class="line">  historyFallback: &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line">config.plugins.push(</span><br><span class="line">  new webpack.HotModuleReplacementPlugin() // 配合hot使用</span><br><span class="line">  new webpack.NoEmitOnErrorsPlugin() // 减少不必要的信息展示</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h2 id="提取第三方资源到单独文件"><a href="#提取第三方资源到单独文件" class="headerlink" title="提取第三方资源到单独文件"></a>提取第三方资源到单独文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">entry: &#123;</span><br><span class="line">  vendor: [&apos;vue&apos;]</span><br><span class="line">&#125;</span><br><span class="line">config.plugins.push(</span><br><span class="line">  new webpack.optimize.CommonsChunkPlugin(&#123;</span><br><span class="line">    name: &apos;vendor&apos;</span><br><span class="line">  &#125;)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h2 id="打包优化"><a href="#打包优化" class="headerlink" title="打包优化"></a>打包优化</h2><h3 id="查看项目打包-webpack-bundle-analyzer"><a href="#查看项目打包-webpack-bundle-analyzer" class="headerlink" title="查看项目打包(webpack-bundle-analyzer)"></a>查看项目打包(webpack-bundle-analyzer)</h3><p>webpack有个插件，可以查看项目一共打了多少包，每个包的体积，每个包里面的包情况。<br>首先下载插件<br><code>npm intall webpack-bundle-analyzer --save-dev</code><br>同时在webpack.config.js配置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">const BundleAnalyzerPlugin = require(&apos;webpack-bundle-analyzer&apos;).BundleAnalyzerPlugin;</span><br><span class="line"></span><br><span class="line">webpackConfig.plugins.push(new BundleAnalyzerPlugin());</span><br></pre></td></tr></table></figure></p>
<p>在package.json中添加命令<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;script&quot;: &#123;</span><br><span class="line">  &quot;analyz&quot;: &quot;NODE_ENV=production npm_config_report=true npm run deploy:prod&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="webpack外部扩展"><a href="#webpack外部扩展" class="headerlink" title="webpack外部扩展"></a>webpack外部扩展</h3><p>引入CDN资源<br>需要配置webpack，使其打包的时候不在将这些资源打包。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">const webpackConfig = &#123;</span><br><span class="line">  name: &apos;client&apos;,</span><br><span class="line">  target: &apos;web&apos;,</span><br><span class="line">  devtool: config.compiler_devtool,</span><br><span class="line">  resolve: &#123;</span><br><span class="line">    root: paths.client(),</span><br><span class="line">    extensions: [&apos;&apos;, &apos;.js&apos;, &apos;.jsx&apos;, &apos;.json&apos;],</span><br><span class="line">  &#125;,</span><br><span class="line">  externals: &#123;</span><br><span class="line">    &apos;react&apos;: &apos;React&apos;,</span><br><span class="line">    &apos;react-dom&apos;: &apos;ReactDOM&apos;,</span><br><span class="line">    &apos;react-router&apos;: &apos;ReactRouter&apos;,</span><br><span class="line">    &apos;redux&apos;: &apos;Redux&apos;,</span><br><span class="line">    &apos;history&apos;: &apos;History&apos;</span><br><span class="line">  &#125;,</span><br><span class="line">  module: &#123;&#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="DLL"><a href="#DLL" class="headerlink" title="DLL"></a>DLL</h3><p>dll 全称是：dynamic link library（动态链接库）<br>dll方式也就是通过配置，告诉webpack指定库在项目中的位置，从而直接引入，不将其打包在内。<br>上面介绍的方式是将包放到cdn上，build的时候不在引入对应的包；<br>dll方式就是指定包在项目中，build的时候不在打包对应的包，使用的时候引入。<br>webpack通过webpack.DllPlugin与webpack.DllReferencePlugin两个内嵌插件实现此功能。<br>新建webpack.dll.config.js<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">const path = require(&apos;path&apos;)</span><br><span class="line">const webpack = require(&apos;webpack&apos;)</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">  entry: &#123;</span><br><span class="line">    vendor: [&apos;vue&apos;, &apos;vue-router&apos;, &apos;vuex&apos;, &apos;axios&apos;, &apos;vuex-router-sync&apos;, &apos;mint-ui&apos;]</span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.resolve(__dirname, &apos;../static&apos;),</span><br><span class="line">    filename: &apos;[name].dll.js&apos;,</span><br><span class="line">    library: &apos;[name]_library&apos;</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    new webpack.DllPlugin(&#123;</span><br><span class="line">      path: path.resolve(__dirname, &apos;../[name]-manifest.json&apos;),</span><br><span class="line">      name: &apos;[name]_library&apos;,</span><br><span class="line">      context: __dirname</span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>webpack.DllPlugin选项：<br>path：manifest.json文件的输出路径，这个文件会用于后续的业务代码打包；<br>name：dll暴露的对象名，要跟output.library保持一致;<br>context：解析包路径的上下文，这个要跟接下来配置的 webpack.config.js 一致。<br>运行文件<br>运行：webpack –progress –colors –config build/webpack.dll.config.js<br>生成两个文件，一个是打包好的vendor.dll.js，另外一个是vendor-mainifest.json<br>配置webpack.config.js<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">plugins: [</span><br><span class="line">  new webpack.DllReferencePlugin(&#123;</span><br><span class="line">    context: __dirname,</span><br><span class="line">    manifest: require(&apos;../vendor-manifest.json&apos;)</span><br><span class="line">  &#125;)</span><br><span class="line">]</span><br></pre></td></tr></table></figure></p>
<p>webpack.DllReferencePlugin的选项中：<br>context：需要跟之前保持一致，这个用来指导webpack匹配manifest.json中库的路径；<br>manifest：用来引入刚才输出的manifest.json文件。<br>生成vendor.dll.js文件后，在index.html中引入<code>&lt;script src=&quot;./static/dll/vendor.dll.js&quot;&gt;&lt;/script&gt;</code></p>
<p>设置vue-cli打开网址可以通过localhost、本地ip地址访问<br>使用devServer。设置host为0.0.0.0，或者在命令行中加入–host 0.0.0.0，修改open为false，通过opn模块打开网页地址<br>不使用devServer。删除webpack.dev.conf.js文件中的devServer，新建server.js文件，在通过express建立服务器，使用opn打开网页地址</p>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><ul>
<li>zip-webpack-plugin压缩打包后的文件</li>
</ul>
<p><strong>安装babel</strong><br>babel-loader babel-core</p>
<p><strong>遍历获取文件名</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">function getEntries(dirName)&#123;</span><br><span class="line">  var jsDir＝path.join(srcDir,dirName),</span><br><span class="line">      entriesFiles＝glob.sync(jsDir+&apos;/*/*.js&apos;),</span><br><span class="line">      map＝&#123;&#125;</span><br><span class="line">  entriesFiles.forEach(function()&#123;</span><br><span class="line">    var fileName＝item.slice(item.lastIndexOf(&apos;\/&apos;)+1,item.lastIndexOf(&apos;.&apos;))</span><br><span class="line">    if(process.env.NODE_ENV===&apos;dev&apos;)&#123;</span><br><span class="line">      </span><br><span class="line">    &#125;else&#123;</span><br><span class="line">      map[fieName]=item</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="报错"><a href="#报错" class="headerlink" title="报错"></a>报错</h2><p>‘cross-env’ 不是内部或外部命令，也不是可运行的程序或批处理文件。<br>安装cross-env插件</p>
<p>cross-env NODE_ENV=test被 new webpack.DefinePlugin({‘process.env’: require(‘../config/dev.env’)}) 覆盖问题<br>使用cross-env NODE_ENV只在编译代码中生效，不在项目代码中生效<br>在config文件夹中新建test.env.js文件，定义其NODE_ENV为test，在调用webpack.DefinePlugin之前判断其process.env.NODE_ENV</p>
<p>使用node(8.x)版本运行npm install以后，如果切换到node(6.x)版本，build的时候会报错</p>
<p>使用vux框架，引用swiper插件打包时，ERROR in static/js/vendor.ca6b94cef1413d8d46f1.js from UglifyJs<br>修改引用方式，将swiper改为swiper/dist/js/swiper</p>
<h2 id="webpack4"><a href="#webpack4" class="headerlink" title="webpack4"></a>webpack4</h2><p><a href="https://www.cnblogs.com/carrotWu/p/8665720.html" target="_blank" rel="noopener">https://www.cnblogs.com/carrotWu/p/8665720.html</a><br><a href="https://juejin.im/entry/5c302140f265da611b587f99" target="_blank" rel="noopener">https://juejin.im/entry/5c302140f265da611b587f99</a></p>
<p>config/index.js相关说明<br><a href="https://www.cnblogs.com/whkl-m/p/6627864.html" target="_blank" rel="noopener">https://www.cnblogs.com/whkl-m/p/6627864.html</a></p>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2019-02-17T04:55:03.741Z" itemprop="dateUpdated">2019-02-17 04:55:03</time>
</span><br>


        
        以上内容为个人记录
        
    </div>
    
    <footer>
        <a href="https://tragiclife.github.io">
            <img src="/img/avatar.jpg" alt="薛鸿杰">
            薛鸿杰
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tool/">tool</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/webpack/">webpack</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://tragiclife.github.io/front-end/tools/webpack/&title=《webpack》 — 薛鸿杰的博客&pic=https://tragiclife.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://tragiclife.github.io/front-end/tools/webpack/&title=《webpack》 — 薛鸿杰的博客&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://tragiclife.github.io/front-end/tools/webpack/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《webpack》 — 薛鸿杰的博客&url=https://tragiclife.github.io/front-end/tools/webpack/&via=https://tragiclife.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://tragiclife.github.io/front-end/tools/webpack/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/back-end/linux/linux/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">linux</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/front-end/tools/git/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Git</h4>
      </a>
    </div>
  
</nav>



    

















</article>



</div>

        <footer class="footer">
    <!-- <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style="display:none">
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style="display:none">
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>博客内容遵循 <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span>
        </p>
    </div> -->
    <div class="bottom">
        <p><span>薛鸿杰 &copy; 2018 - 2021</span>
            <span>
                
                <a href="https://beian.miit.gov.cn/" target="_blank">粤ICP备18140620号-1</a><br>
                
                <!-- Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a> -->
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://tragiclife.github.io/front-end/tools/webpack/&title=《webpack》 — 薛鸿杰的博客&pic=https://tragiclife.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://tragiclife.github.io/front-end/tools/webpack/&title=《webpack》 — 薛鸿杰的博客&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://tragiclife.github.io/front-end/tools/webpack/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《webpack》 — 薛鸿杰的博客&url=https://tragiclife.github.io/front-end/tools/webpack/&via=https://tragiclife.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://tragiclife.github.io/front-end/tools/webpack/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACKElEQVR42u3aQW7DMAwEwPz/0+m1QFp3V3SCWh6fgsaxNSpAkCIfj/h6fru+/+X129c7X+8/fubrnaddGBgYl2U8D681xnwj8rVhYGDch/Hbi9fumYTj9r0YGBgYx4ldG7iTFBADAwNjzsjL1HwLMDAwMBJGUsS2pLww/mgtjoGBcUFGfur++c9v6W9gYGBcivEsr/YQf5IaFqvCwMDYmpEHuDxxbBuWawEXAwPjnoz5IVp+9H+cdLYBGgMD456MtmHZVpprgD9WhYGBsTWjLUHzUnZyqLcY7jEwMDZltIteK0rzI7zR/wEDA2NTRhsEJ8lcvjUnLB0DA2MjRl7Etu2BNqC3h3eLtTgGBsalGHkCt3YAlwflfPt+eDIGBsbWjHa4oT0IS7apfeOvv8XAwNiUkYfR/Nu2VbCWOGJgYNyN0aZ9kwGyJAWstxgDA2NrRl6+HofRdiBjjbrYGMDAwNiCsTZa0W7HPLzWXVkMDIyNGMl4Vj7IlSw6f0JREmNgYNyAcVYiOAm++UhZXcRiYGBswZgc9Lchu00uMTAwMNYCbvKCyRPa0hoDA2NXxrwlkA91nVU2v6V5iYGB8Y8Z57Y580Qzn+Zaax5gYGDsxzhrcXmbsx1BiwI6BgbGDRhJAtcuZW2b2tCPgYGBkYTFvEBdO54rslcMDAyM8ZDE5Fd/bCIGBsYNGGtjYZPBi6RkTcYyMDAw7sCY5F1r5W67iHnpi4GBcVnGFxBdIuAsc/TvAAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
