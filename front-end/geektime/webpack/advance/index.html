<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>玩转webpack-webpack进阶用法 | 薛鸿杰的博客</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#6C88B7">
    
    
    <meta name="keywords" content="tool,webpack,极客时间">
    <meta name="description" content="当前构建时的问题每次构建的时候不会清理目录，造成构建的输出目录 output 文件越来越多 通过 npm scripts 清理构建目录  rm -rf ./dist &amp;amp;&amp;amp; webpack rimraf ./dist &amp;amp;&amp;amp; webpack 使用 clean-webpack-plugin，默认会删除 output 指定的输出目录  123456789const Clea">
<meta name="keywords" content="tool,webpack,极客时间">
<meta property="og:type" content="article">
<meta property="og:title" content="玩转webpack-webpack进阶用法">
<meta property="og:url" content="https://tragiclife.github.io/front-end/geektime/webpack/advance/index.html">
<meta property="og:site_name" content="薛鸿杰的博客">
<meta property="og:description" content="当前构建时的问题每次构建的时候不会清理目录，造成构建的输出目录 output 文件越来越多 通过 npm scripts 清理构建目录  rm -rf ./dist &amp;amp;&amp;amp; webpack rimraf ./dist &amp;amp;&amp;amp; webpack 使用 clean-webpack-plugin，默认会删除 output 指定的输出目录  123456789const Clea">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://tragiclife.github.io/front-end/geektime/webpack/advance/source-map.png">
<meta property="og:updated_time" content="2020-04-05T16:36:09.559Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="玩转webpack-webpack进阶用法">
<meta name="twitter:description" content="当前构建时的问题每次构建的时候不会清理目录，造成构建的输出目录 output 文件越来越多 通过 npm scripts 清理构建目录  rm -rf ./dist &amp;amp;&amp;amp; webpack rimraf ./dist &amp;amp;&amp;amp; webpack 使用 clean-webpack-plugin，默认会删除 output 指定的输出目录  123456789const Clea">
<meta name="twitter:image" content="https://tragiclife.github.io/front-end/geektime/webpack/advance/source-map.png">
    
        <link rel="alternate" type="application/atom+xml" title="薛鸿杰的博客" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand2.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">薛鸿杰</h5>
          <a href="mailto:xuehongjiej@163.com" title="xuehongjiej@163.com" class="mail">xuehongjiej@163.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/">
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives">
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags">
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/TragicLife" target="_blank">
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">玩转webpack-webpack进阶用法</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">玩转webpack-webpack进阶用法</h1>
        <h5 class="subtitle">
            
                <time datetime="2020-04-01T22:50:11.000Z" itemprop="datePublished" class="page-time">
  2020-04-01
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#当前构建时的问题"><span class="post-toc-number">1.</span> <span class="post-toc-text">当前构建时的问题</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#样式自动补齐前缀"><span class="post-toc-number">2.</span> <span class="post-toc-text">样式自动补齐前缀</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#px-转-rem"><span class="post-toc-number">3.</span> <span class="post-toc-text">px 转 rem</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#资源内联"><span class="post-toc-number">4.</span> <span class="post-toc-text">资源内联</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#HTML-和-JS-内联"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">HTML 和 JS 内联</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#CSS-内联"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">CSS 内联</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#多页面打包"><span class="post-toc-number">5.</span> <span class="post-toc-text">多页面打包</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#使用-source-map"><span class="post-toc-number">6.</span> <span class="post-toc-text">使用 source map</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#source-map-关键字"><span class="post-toc-number">6.1.</span> <span class="post-toc-text">source map 关键字</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#source-map-类型"><span class="post-toc-number">6.2.</span> <span class="post-toc-text">source map 类型</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#文件拆分"><span class="post-toc-number">7.</span> <span class="post-toc-text">文件拆分</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#基础库分离"><span class="post-toc-number">7.1.</span> <span class="post-toc-text">基础库分离</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#使用-SplitChunksPlugin-分离"><span class="post-toc-number">7.2.</span> <span class="post-toc-text">使用 SplitChunksPlugin 分离</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#tree-shaking-摇树优化"><span class="post-toc-number">8.</span> <span class="post-toc-text">tree shaking(摇树优化)</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#模块转换"><span class="post-toc-number">9.</span> <span class="post-toc-text">模块转换</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#分析"><span class="post-toc-number">9.1.</span> <span class="post-toc-text">分析</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#模块机制"><span class="post-toc-number">9.2.</span> <span class="post-toc-text">模块机制</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#scope-hoisting"><span class="post-toc-number">10.</span> <span class="post-toc-text">scope hoisting</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#原理"><span class="post-toc-number">10.1.</span> <span class="post-toc-text">原理</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#使用"><span class="post-toc-number">10.2.</span> <span class="post-toc-text">使用</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#懒加载-JS-脚本"><span class="post-toc-number">11.</span> <span class="post-toc-text">懒加载 JS 脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ESLint"><span class="post-toc-number">12.</span> <span class="post-toc-text">ESLint</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#行业⾥面优秀的-ESLint-规范实践"><span class="post-toc-number">12.1.</span> <span class="post-toc-text">行业⾥面优秀的 ESLint 规范实践</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#集成使用"><span class="post-toc-number">12.2.</span> <span class="post-toc-text">集成使用</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#打包库和组件"><span class="post-toc-number">13.</span> <span class="post-toc-text">打包库和组件</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#如何将库暴露出去"><span class="post-toc-number">13.1.</span> <span class="post-toc-text">如何将库暴露出去</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#指定对-min-压缩"><span class="post-toc-number">13.2.</span> <span class="post-toc-text">指定对.min 压缩</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#设置入口文件"><span class="post-toc-number">13.3.</span> <span class="post-toc-text">设置入口文件</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#SSR"><span class="post-toc-number">14.</span> <span class="post-toc-text">SSR</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#优势"><span class="post-toc-number">14.1.</span> <span class="post-toc-text">优势</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#存在的问题与解决方案"><span class="post-toc-number">14.2.</span> <span class="post-toc-text">存在的问题与解决方案</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#解决样式不显示问题和首屏数据"><span class="post-toc-number">14.3.</span> <span class="post-toc-text">解决样式不显示问题和首屏数据</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#日志信息"><span class="post-toc-number">15.</span> <span class="post-toc-text">日志信息</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#统计信息-stats"><span class="post-toc-number">15.1.</span> <span class="post-toc-text">统计信息 stats</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#优化命令行的构建日志"><span class="post-toc-number">15.2.</span> <span class="post-toc-text">优化命令行的构建日志</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#构建"><span class="post-toc-number">16.</span> <span class="post-toc-text">构建</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#如何判断构建是否成功"><span class="post-toc-number">16.1.</span> <span class="post-toc-text">如何判断构建是否成功</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#构建异常和中断处理"><span class="post-toc-number">16.2.</span> <span class="post-toc-text">构建异常和中断处理</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#如何主动捕获并处理构建错误"><span class="post-toc-number">16.3.</span> <span class="post-toc-text">如何主动捕获并处理构建错误</span></a></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-front-end/geektime/webpack/advance" class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">玩转webpack-webpack进阶用法</h1>
        <div class="post-meta">
            <time class="post-time" title="2020-04-01 22:50:11" datetime="2020-04-01T22:50:11.000Z" itemprop="datePublished">2020-04-01</time>

            


            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style="display:none">
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h2 id="当前构建时的问题"><a href="#当前构建时的问题" class="headerlink" title="当前构建时的问题"></a>当前构建时的问题</h2><p>每次构建的时候不会清理目录，造成构建的输出目录 output 文件越来越多</p>
<p>通过 npm scripts 清理构建目录</p>
<ul>
<li><code>rm -rf ./dist &amp;&amp; webpack</code></li>
<li><code>rimraf ./dist &amp;&amp; webpack</code></li>
<li>使用 <code>clean-webpack-plugin</code>，默认会删除 output 指定的输出目录</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">const CleanWebpackPlugin = require(&apos;clean-webpack-plugin&apos;);</span><br><span class="line">// 编译时出现CleanWebpackPlugin is not a constructor错误，则使用下面的引用方式</span><br><span class="line">const &#123; CleanWebpackPlugin &#125; = require(&apos;clean-webpack-plugin&apos;); // 新版本用法</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    new CleanWebpackPlugin(),</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="样式自动补齐前缀"><a href="#样式自动补齐前缀" class="headerlink" title="样式自动补齐前缀"></a>样式自动补齐前缀</h2><p>使用 autoprefixer 插件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">  module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: /\.less$/,</span><br><span class="line">        use: [</span><br><span class="line">          &apos;style-loader&apos;,</span><br><span class="line">          &apos;css-loader&apos;,</span><br><span class="line">          &apos;less-loader&apos;,</span><br><span class="line">          &#123;</span><br><span class="line">            loader: &apos;postcss-loader&apos;,</span><br><span class="line">            options: &#123;</span><br><span class="line">              plugins: () =&gt; &#123;</span><br><span class="line">                require(&apos;autoprefixer&apos;)(&#123;</span><br><span class="line">                  browsers: [&apos;last 2 version&apos;, &apos;&gt;1%&apos;, &apos;iOS 7&apos;]</span><br><span class="line">                &#125;)</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="px-转-rem"><a href="#px-转-rem" class="headerlink" title="px 转 rem"></a>px 转 rem</h2><p>使⽤用 <code>px2rem-loader</code>，配合手淘的 <code>lib-flexible</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">  module: &#123;</span><br><span class="line">    rules: [&#123;</span><br><span class="line">      test: /\.less$/,</span><br><span class="line">      use: [</span><br><span class="line">         &apos;style-loader&apos;,</span><br><span class="line">         &apos;css-loader&apos;,</span><br><span class="line">         &apos;less-loader&apos;,</span><br><span class="line">         &#123;</span><br><span class="line">          loader: &quot;px2rem-loader&quot;,</span><br><span class="line">          options: &#123;</span><br><span class="line">            remUnit: 75,</span><br><span class="line">            remPrecision: 8</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;]</span><br><span class="line">    &#125;]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="资源内联"><a href="#资源内联" class="headerlink" title="资源内联"></a>资源内联</h2><p>资源内联的意义：</p>
<ul>
<li>⻚面框架的初始化脚本</li>
<li>上报相关打点</li>
<li>css 内联避免⻚面闪动</li>
<li>⼩图片或者字体内联 (<code>url-loader</code>)</li>
</ul>
<h3 id="HTML-和-JS-内联"><a href="#HTML-和-JS-内联" class="headerlink" title="HTML 和 JS 内联"></a>HTML 和 JS 内联</h3><p>通过 <code>raw-loader</code> 进行内联</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 内联html</span><br><span class="line">&lt;script&gt;$&#123;require(&apos; raw-loader!babel-loader!. /meta.html&apos;)&#125;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">// 内联js</span><br><span class="line">&lt;script&gt;$&#123;require(&apos;raw-loader!babel-loader!../node_modules/lib-flexible&apos;)&#125;&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h3 id="CSS-内联"><a href="#CSS-内联" class="headerlink" title="CSS 内联"></a>CSS 内联</h3><ul>
<li>借助 style-loader</li>
<li>使用 html-inline-css-webpack-plugin</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">  module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: /\.scss$/,</span><br><span class="line">        use: [</span><br><span class="line">          &#123;</span><br><span class="line">            loader: &apos;style-loader&apos;,</span><br><span class="line">            options: &#123;</span><br><span class="line">              insertAt: &apos;top&apos;, // 样式插入到&lt;head&gt;</span><br><span class="line">              singleton: true, //将所有的style标签合并成一个</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">          &apos;css-loader&apos;,</span><br><span class="line">          &apos;sass-loader&apos;,</span><br><span class="line">        ],</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="多页面打包"><a href="#多页面打包" class="headerlink" title="多页面打包"></a>多页面打包</h2><p>利用 <code>glob.sync</code> 动态获取 entry 和设置 html-webpack-plugin 的数量，解决手动增加 entry 的问题</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">const path = require(&apos;path&apos;);</span><br><span class="line">const glob = require(&apos;glob&apos;);</span><br><span class="line">const HtmlWebpackPlugin = require(&apos;html-webpack-plugin&apos;);</span><br><span class="line"></span><br><span class="line">const entry = &#123;&#125;;</span><br><span class="line">const htmlPlugin = [];</span><br><span class="line"></span><br><span class="line">// 获取所有页面入口</span><br><span class="line">const fileList = glob.sync(path.join(__dirname, &apos;./src/*/index.js&apos;));</span><br><span class="line">fileList.forEach((file) =&gt; &#123;</span><br><span class="line">  const match = file.match(/src\/(.*)\/index.js/);</span><br><span class="line">  const fileName = match &amp;&amp; match[1];</span><br><span class="line"></span><br><span class="line">  entry[fileName] = file;</span><br><span class="line">  htmlPlugin.push(</span><br><span class="line">    new HtmlWebpackPlugin(&#123;</span><br><span class="line">      template: `./src/$&#123;fileName&#125;/index.html`,</span><br><span class="line">      filename: `$&#123;fileName&#125;.html`,</span><br><span class="line">      chunks: [fileName],</span><br><span class="line">      inject: true,</span><br><span class="line">    &#125;)</span><br><span class="line">  );</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">  entry,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: &apos;[name].js&apos;, // 通过占位符确保文件名称的唯一</span><br><span class="line">    path: __dirname + &apos;/dist&apos;, // 输出的目录</span><br><span class="line">  &#125;,</span><br><span class="line">  mode: &apos;production&apos;,</span><br><span class="line">  plugins: htmlPlugin,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="使用-source-map"><a href="#使用-source-map" class="headerlink" title="使用 source map"></a>使用 source map</h2><p>作用：通过 source map 定位到源代码</p>
<blockquote>
<p>开发环境开启，线上环境关闭</p>
</blockquote>
<h3 id="source-map-关键字"><a href="#source-map-关键字" class="headerlink" title="source map 关键字"></a>source map 关键字</h3><ul>
<li><code>eval</code>: 使用 eval 包裹模块代码</li>
<li><code>cheap</code>: 不包含列列信息</li>
<li><code>inline</code>: 将.map 作为 DataURI 嵌⼊，不单独⽣成.map ⽂文件</li>
<li><code>module</code>:包含 loader 的 sourcemap</li>
</ul>
<h3 id="source-map-类型"><a href="#source-map-类型" class="headerlink" title="source map 类型"></a>source map 类型</h3><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/front-end/geektime/webpack/advance/./source-map.png" alt="source map类型" title="">
                </div>
                <div class="image-caption">source map类型</div>
            </figure>
<h2 id="文件拆分"><a href="#文件拆分" class="headerlink" title="文件拆分"></a>文件拆分</h2><h3 id="基础库分离"><a href="#基础库分离" class="headerlink" title="基础库分离"></a>基础库分离</h3><p>使用 html-webpack-externals-plugin</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">const HtmlWebpackExternalsPlugin = require(&apos;html-webpack-externals-plugin&apos;);</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    new HtmlWebpackExternalsPlugin(&#123;</span><br><span class="line">      externals: [</span><br><span class="line">        &#123;</span><br><span class="line">          module: &apos;vue&apos;,</span><br><span class="line">          entry: &apos;https://cdn.bootcss.com/vue/2.6.11/vue.min.js&apos;,</span><br><span class="line">          global: &apos;Vue&apos;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          module: &apos;jquery&apos;,</span><br><span class="line">          entry: &apos;https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js&apos;,</span><br><span class="line">          global: &apos;jQuery&apos;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="使用-SplitChunksPlugin-分离"><a href="#使用-SplitChunksPlugin-分离" class="headerlink" title="使用 SplitChunksPlugin 分离"></a>使用 SplitChunksPlugin 分离</h3><p>Webpack4 内置的，用于替代 CommonsChunkPlugin 插件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">  optimization: &#123;</span><br><span class="line">    splitChunks: &#123;</span><br><span class="line">      chunks: &apos;async&apos;,</span><br><span class="line">      minSize: 30000, // 最小大小，即当抽取的公共模块的大小，大于minSize所设置的值，才起作用</span><br><span class="line">      maxSize: 0,</span><br><span class="line">      minChunks: 1, // 最少引入次数，即当块的数量大于等于minChunks时，才起作用</span><br><span class="line">      maxAsyncRequests: 5, // 浏览器同时请求的次数</span><br><span class="line">      maxInitialRequests: 3,</span><br><span class="line">      automaticNameDelimiter: &apos;~&apos;,</span><br><span class="line">      name: true,</span><br><span class="line">      // 缓存组，抽取公共模块</span><br><span class="line">      cacheGroups: &#123;</span><br><span class="line">        vendors: &#123;</span><br><span class="line">          name: &apos;vendors&apos;,</span><br><span class="line">          test: /[\\/]node_modules[\\/]/, // 匹配规则，说明要匹配的项</span><br><span class="line">          priority: -10, // 优先级，决定执行顺序</span><br><span class="line">          minSize: 0,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>chunks 参数说明：</p>
<ul>
<li>async 异步引⼊入的库进⾏行行分离(默认)</li>
<li>initial 同步引⼊入的库进⾏行行分离</li>
<li>all 所有引⼊入的库进⾏行行分离(推荐)</li>
</ul>
<h2 id="tree-shaking-摇树优化"><a href="#tree-shaking-摇树优化" class="headerlink" title="tree shaking(摇树优化)"></a>tree shaking(摇树优化)</h2><p>1 个模块可能有多个方法，只要其中的某个⽅法使⽤到了，则整个⽂件都会被打到 bundle ⾥面去，tree shaking 就是只把⽤到的⽅法打⼊ bundle ，没⽤到的⽅法会在 uglify 阶段被擦除掉。</p>
<p>如何使用：</p>
<ul>
<li>webpack 默认支持，在 .babelrc ⾥设置 modules: false 即可</li>
<li>production mode 的情况下默认开启</li>
</ul>
<blockquote>
<p>要求：必须是 ES6 的语法，CJS 的⽅式不支持</p>
</blockquote>
<h2 id="模块转换"><a href="#模块转换" class="headerlink" title="模块转换"></a>模块转换</h2><h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><ul>
<li>被 webpack 转换后的模块会带上⼀层包裹</li>
<li>import 会被转换成 <code>__webpack_require</code></li>
</ul>
<h3 id="模块机制"><a href="#模块机制" class="headerlink" title="模块机制"></a>模块机制</h3><ul>
<li>打包出来的是一个 IIFE (匿匿名闭包)</li>
<li>modules 是一个数组，每⼀项是一个模块初始化函数</li>
<li><code>__webpack_require</code> ⽤用来加载模块，返回 module.exports</li>
<li>通过 WEBPACK_REQUIRE_METHOD(0) 启动程序</li>
</ul>
<h2 id="scope-hoisting"><a href="#scope-hoisting" class="headerlink" title="scope hoisting"></a>scope hoisting</h2><h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p>将所有模块的代码按照引用顺序放在⼀个函数作⽤域⾥，然后适当的重命名⼀些变量以防⽌变量名冲突</p>
<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><ul>
<li>mode 为 production 默认开启</li>
<li>在 plugins 添加 <code>new webpack.optimize.ModuleConcatenationPlugin()</code>使用</li>
</ul>
<h2 id="懒加载-JS-脚本"><a href="#懒加载-JS-脚本" class="headerlink" title="懒加载 JS 脚本"></a>懒加载 JS 脚本</h2><ul>
<li>CommonJS：require.ensure</li>
<li>ES6：动态 import（⽬前还没有原⽣支持，需要 babel 转换）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// 安装babel插件</span><br><span class="line">npm install @babel/plugin-syntax-dynamic-import</span><br><span class="line"></span><br><span class="line">// 在.babelrc文件中设置</span><br><span class="line">&quot;plugins&quot;: [</span><br><span class="line">  &quot;@babel/plugin-syntax-dynamic-import&quot;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">// 使用，webpack通过jsonp的方式加载</span><br><span class="line">import(&apos;引入的模块&apos;)</span><br></pre></td></tr></table></figure>
<h2 id="ESLint"><a href="#ESLint" class="headerlink" title="ESLint"></a>ESLint</h2><h3 id="行业⾥面优秀的-ESLint-规范实践"><a href="#行业⾥面优秀的-ESLint-规范实践" class="headerlink" title="行业⾥面优秀的 ESLint 规范实践"></a>行业⾥面优秀的 ESLint 规范实践</h3><ul>
<li>Airbnb: eslint-config-airbnb、 eslint-config-airbnb-base</li>
<li>腾讯：<ul>
<li>alloyteam 团队 eslint-config-alloy(<a href="https://github.com/AlloyTeam/eslint-config-alloy" target="_blank" rel="noopener">https://github.com/AlloyTeam/eslint-config-alloy</a>)</li>
<li>ivweb 团队：eslint-config-ivweb(<a href="https://github.com/feflow/eslint-config-ivweb" target="_blank" rel="noopener">https://github.com/feflow/eslint-config-ivweb</a>)</li>
</ul>
</li>
</ul>
<h3 id="集成使用"><a href="#集成使用" class="headerlink" title="集成使用"></a>集成使用</h3><ul>
<li>webpack 与 CI/CD 集成</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// 本地开发阶段增加 precommit 钩⼦</span><br><span class="line">// 安装husky</span><br><span class="line">npm install husky --save-dev</span><br><span class="line"></span><br><span class="line">// 增加 npm script，通过 lint-staged 增量检查修改的⽂件</span><br><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">  &quot;precommit&quot;: &quot;lint-staged&quot;</span><br><span class="line">&#125;,</span><br><span class="line">&quot;lint-staged&quot;: &#123;</span><br><span class="line">  &quot;linters&quot;: &#123;</span><br><span class="line">    &quot;*.&#123;js,scss&#125;&quot;: [</span><br><span class="line">      &quot;eslint --fix&quot;,</span><br><span class="line">      &quot;git add&quot;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<ul>
<li>webpack 与 ESLint 集成</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// 安装依赖babel-eslint、eslint、eslint-loader、eslint-plugin-import</span><br><span class="line">// 使用eslint-loader，在构建时检查JS规范</span><br><span class="line">module.exports = &#123;</span><br><span class="line">  module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: /\.js$/,</span><br><span class="line">        exclude: /node_modules/,</span><br><span class="line">        use: [&apos;babel-loader&apos;, &apos;eslint-loader&apos;],</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="打包库和组件"><a href="#打包库和组件" class="headerlink" title="打包库和组件"></a>打包库和组件</h2><h3 id="如何将库暴露出去"><a href="#如何将库暴露出去" class="headerlink" title="如何将库暴露出去"></a>如何将库暴露出去</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">  mode: &apos;production&apos;,</span><br><span class="line">  entry: &#123;</span><br><span class="line">    &apos;large-number&apos;: &apos;./src/index.js&apos;,</span><br><span class="line">    &apos;large-number.min&apos;: &apos;./src/index.js&apos;,</span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: &apos;[name].js&apos;,</span><br><span class="line">    library: &apos;largeNumber&apos;, // 指定库的全局变量量</span><br><span class="line">    libraryExport: &apos;default&apos;,</span><br><span class="line">    libraryTarget: &apos;umd&apos;, // ⽀支持库引⼊入的⽅方式</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="指定对-min-压缩"><a href="#指定对-min-压缩" class="headerlink" title="指定对.min 压缩"></a>指定对.min 压缩</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">  optimization: &#123;</span><br><span class="line">    minimize: true,</span><br><span class="line">    minimizer: [</span><br><span class="line">      new TerserPlugin(&#123;</span><br><span class="line">        include: /\.min\.js$/,</span><br><span class="line">      &#125;),</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="设置入口文件"><a href="#设置入口文件" class="headerlink" title="设置入口文件"></a>设置入口文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 根据package.json文件中main设置的文件编写如下代码</span><br><span class="line">if (process.env.NODE_ENV === &apos;production&apos;) &#123;</span><br><span class="line">  module.exports = require(&apos;./dist/large-number.min.js&apos;);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">  module.exports = require(&apos;./dist/large-number.js&apos;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="SSR"><a href="#SSR" class="headerlink" title="SSR"></a>SSR</h2><p>所有模板等资源都存储在服务端，一个 HTML 返回所有数据</p>
<h3 id="优势"><a href="#优势" class="headerlink" title="优势"></a>优势</h3><ul>
<li>减少白屏时间</li>
<li>对于 SEO 友好</li>
</ul>
<h3 id="存在的问题与解决方案"><a href="#存在的问题与解决方案" class="headerlink" title="存在的问题与解决方案"></a>存在的问题与解决方案</h3><ul>
<li><p>浏览器的全局变量 (Node.js 中没有 document, window)</p>
<ul>
<li><p>组件适配：将不兼容的组件根据打包环境进⾏适配</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if(typeof window === &apos;undefined&apos;) &#123;</span><br><span class="line">  global.window = &#123;&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>请求适配：将 fetch 或者 ajax 发送请求的写法改成 isomorphic-fetch 或者 axios</p>
</li>
</ul>
</li>
<li>样式问题 (Node.js 无法解析 css)<ul>
<li>方案一：服务端打包通过 ignore-loader 忽略掉 CSS 的解析</li>
<li>方案二：将 style-loader 替换成 isomorphic-style-loader</li>
</ul>
</li>
</ul>
<h3 id="解决样式不显示问题和首屏数据"><a href="#解决样式不显示问题和首屏数据" class="headerlink" title="解决样式不显示问题和首屏数据"></a>解决样式不显示问题和首屏数据</h3><p>使⽤打包出来的浏览器端 html 为模板，设置占位符，动态插入组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// index.html</span><br><span class="line">&lt;div id=&quot;root&quot;&gt;&lt;!--HTML_PLACEHOLDER--&gt;&lt;/div&gt;</span><br><span class="line">&lt;!--INITIAL_DATA_PLACEHOLDER--&gt;</span><br><span class="line"></span><br><span class="line">// node服务中，替换模板和数据</span><br><span class="line">const renderMarkup = (str) =&gt; &#123;</span><br><span class="line">  const dataStr = JSON.stringify(data);</span><br><span class="line">  return template.replace(&apos;&lt;!--HTML_PLACEHOLDER--&gt;&apos;, str)</span><br><span class="line">    .replace(&apos;&lt;!--INITIAL_DATA_PLACEHOLDER--&gt;&apos;, `&lt;script&gt;window.__initial_data=$&#123;dataStr&#125;&lt;/script&gt;`);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="日志信息"><a href="#日志信息" class="headerlink" title="日志信息"></a>日志信息</h2><h3 id="统计信息-stats"><a href="#统计信息-stats" class="headerlink" title="统计信息 stats"></a>统计信息 stats</h3><table>
<thead>
<tr>
<th>stats 属性值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>errors-only</td>
<td>只在发生错误时输出</td>
</tr>
<tr>
<td>minimal</td>
<td>只在发生错误或有新的编译时输出</td>
</tr>
<tr>
<td>none</td>
<td>没有输出</td>
</tr>
<tr>
<td>normal</td>
<td>标准输出</td>
</tr>
<tr>
<td>verbose</td>
<td>全部输出</td>
</tr>
</tbody>
</table>
<h3 id="优化命令行的构建日志"><a href="#优化命令行的构建日志" class="headerlink" title="优化命令行的构建日志"></a>优化命令行的构建日志</h3><p>使用 friendly-errors-webpack-plugin</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">const FriendlyErrorsWebpackPlugin = require(&apos;friendly-errors-webpack-plugin&apos;);</span><br><span class="line">module.exports = &#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    new FriendlyErrorsWebpackPlugin(),</span><br><span class="line">  ],</span><br><span class="line">  stats: &apos;error-only&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="构建"><a href="#构建" class="headerlink" title="构建"></a>构建</h2><h3 id="如何判断构建是否成功"><a href="#如何判断构建是否成功" class="headerlink" title="如何判断构建是否成功"></a>如何判断构建是否成功</h3><p>每次构建完成后输入 echo \$?获取错误码，0 为成功</p>
<blockquote>
<p>需要在 git/linux 命令中执行</p>
</blockquote>
<h3 id="构建异常和中断处理"><a href="#构建异常和中断处理" class="headerlink" title="构建异常和中断处理"></a>构建异常和中断处理</h3><p>webpack4 之前的版本构建失败不会抛出错误码 (error code)<br>Node.js 中的 process.exit 规范</p>
<ul>
<li>0 表示成功完成，回调函数中，err 为 null</li>
<li>⾮ 0 表示执⾏失败，回调函数中，err 不为 null，err.code 就是传给 exit 的数字</li>
</ul>
<h3 id="如何主动捕获并处理构建错误"><a href="#如何主动捕获并处理构建错误" class="headerlink" title="如何主动捕获并处理构建错误"></a>如何主动捕获并处理构建错误</h3><p>compiler 在每次构建结束后会触发 done 这个 hook,process.exit 主动处理理构建报错</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    function () &#123;</span><br><span class="line">      // webpack4的写法，webpack3需要写成this.plugin(&apos;done&apos;)</span><br><span class="line">      this.hooks.done.tap(&apos;done&apos;, (stats) =&gt; &#123;</span><br><span class="line">        if (</span><br><span class="line">          stats.compilation.errors &amp;&amp;</span><br><span class="line">          stats.compilation.errors.length &amp;&amp;</span><br><span class="line">          process.argv.indexOf(&apos;--watch&apos;) == -1</span><br><span class="line">        ) &#123;</span><br><span class="line">          console.log(&apos;build error&apos;);</span><br><span class="line">          process.exit(1);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2020-04-05T16:36:09.559Z" itemprop="dateUpdated">2020-04-05 16:36:09</time>
</span><br>


        
        以上内容为个人记录
        
    </div>
    
    <footer>
        <a href="https://tragiclife.github.io">
            <img src="/img/avatar.jpg" alt="薛鸿杰">
            薛鸿杰
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tool/">tool</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/webpack/">webpack</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/极客时间/">极客时间</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://tragiclife.github.io/front-end/geektime/webpack/advance/&title=《玩转webpack-webpack进阶用法》 — 薛鸿杰的博客&pic=https://tragiclife.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://tragiclife.github.io/front-end/geektime/webpack/advance/&title=《玩转webpack-webpack进阶用法》 — 薛鸿杰的博客&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://tragiclife.github.io/front-end/geektime/webpack/advance/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《玩转webpack-webpack进阶用法》 — 薛鸿杰的博客&url=https://tragiclife.github.io/front-end/geektime/webpack/advance/&via=https://tragiclife.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://tragiclife.github.io/front-end/geektime/webpack/advance/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/front-end/geektime/webpack/building-configurationn/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">玩转webpack-webpack构建配置</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/front-end/geektime/webpack/basic/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">玩转webpack-webpack基础用法</h4>
      </a>
    </div>
  
</nav>



    

















</article>



</div>

        <footer class="footer">
    <!-- <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style="display:none">
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style="display:none">
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>博客内容遵循 <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span>
        </p>
    </div> -->
    <div class="bottom">
        <p><span>薛鸿杰 &copy; 2018 - 2021</span>
            <span>
                
                <a href="https://beian.miit.gov.cn/" target="_blank">粤ICP备18140620号-1</a><br>
                
                <!-- Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a> -->
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://tragiclife.github.io/front-end/geektime/webpack/advance/&title=《玩转webpack-webpack进阶用法》 — 薛鸿杰的博客&pic=https://tragiclife.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://tragiclife.github.io/front-end/geektime/webpack/advance/&title=《玩转webpack-webpack进阶用法》 — 薛鸿杰的博客&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://tragiclife.github.io/front-end/geektime/webpack/advance/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《玩转webpack-webpack进阶用法》 — 薛鸿杰的博客&url=https://tragiclife.github.io/front-end/geektime/webpack/advance/&via=https://tragiclife.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://tragiclife.github.io/front-end/geektime/webpack/advance/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACq0lEQVR42u3aQY7jMAwEwPn/p2evC2RtN0nRMwuUT0HiKCofJKapr6/4+v7runr/87q/5+rTz/E/Xx++8PDw8AZTTyZx/92rafXGTN65f0B4eHh4e7yrFTVflKvTun8Qvfng4eHh/U5eUvjmJfLkweHh4eH9X7y8mE6mfmpkPDw8vDd5vaHz4LUX476ateDh4eHFvLyL9Hter/T38PDw8MZd9SRWKJS2rZmMZouHh4e3wJs3t/JjBNVSOy+4Hx46Hh4e3iu8vTZVXjrnLbSHbQkPDw9vgTf58t5hrF7brJmp4OHh4RV58wigWmTP8aP+Hh4eHt6LRwfye/KieSMUxsPDw9vjVafba4DNj1IlxXShv4eHh4d3lFcdaBK85ttGsj00/yvg4eHhFXnJIj6ZUDLdycGC6B48PDy8o7yNbGPS1soX/agJh4eHh/cib9IA67XQJjHxJR4PDw9vjTefaJWRL/rJneUzEXh4eHhjXvkY0+DIVDW2GI2Mh4eHt8BLFtx8C+ltG3kpn28eD2EuHh4e3oBXPS7QOwpQjX1728A/XuPh4eGt8fJWfe/oQC/4qPazHrIWPDw8vEO86n/2HFadSr7oVyMMPDw8vLO8+yHyRtR86oXsJN+i8PDw8BZ4k4AgD3/zkfOjWpOmHR4eHt6cV22A5e/khXgeZ+SbBx4eHt5P8aqhQOGHg6h38sjw8PDwtnmTJLh3mKBaglcPIuDh4eFt8L6LV68BlpfCedgRfYqHh4e3wKsuuL1UOAHk7+SPDw8PD2+PN9kMJvFu/lv5xoCHh4f3Jm9ygOBUEDzZtMof4+Hh4b3Iq7a7quV4r/X1kFLj4eHh/Sgv2STOxsGTKAQPDw9vjzePGM4yJiU+Hh4e3jav+oc/fxDzkKLaGDuQZ+Dh4eHdffcP2YWIvfpN3EIAAAAASUVORK5CYII=" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
